<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <script src="bower_components/d3/d3.js"></script>
  <style type="text/css">
    #directedNetworkContainer {
      width: 752px;
      height: 352px;
      border: 1px solid lightgray;
    }

    path.link {
      fill: none;
      stroke: #666;
      stroke-width: 2.5px;
    }

    marker#direct {
      fill: green;
    }

    path.link.direct {
      stroke: green;
    }

    path.link.resolved {
      stroke-dasharray: 0,2 1;
    }

    circle {
      fill: #ccc;
      stroke: #333;
      stroke-width: 1.5px;
    }

    text {
      font: 10px sans-serif;
      pointer-events: none;
    }

    text.shadow {
      stroke: #fff;
      stroke-width: 3px;
      stroke-opacity: .8;
    }

  </style>
  <title>{{title}}</title>
</head>

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">ANCOR {{version}} Dashboard</a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="active"><a href="/">Dashboard</a></li>
        <li><a href="#/confs">Environments</a></li>
        <li><a href="#">Profile</a></li>
        <li><a href="https://github.com/arguslab/ancor-dashboard/tree/master/doc">Help</a></li>
      </ul>
      <form class="navbar-form navbar-right">
        <input type="text" class="form-control" placeholder="Search...">
      </form>
    </div>
  </div>
</div>

<div class="container-fluid">
  <div class="row">
    <div class="col-sm-3 col-md-2 sidebar">
      <ul class="nav nav-sidebar">
        <li class="active"><a href="/">Overview</a></li>
        <li><a href="#/confs">Environments</a></li>
        <li><a href="#/tasks">Tasks</a></li>
        <li><a href="#/deploy">Deploy</a></li>
      </ul>
    </div>
    <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
      <h1 class="page-header">{{goalName}} Overview</h1>

      <div class="row placeholders">
        <div class="row text-center">
          <div class="col-md-4">
            <h1 class="text-primary" style="font-size: 60px;">{{totalInstances}}</h1> Instances
          </div>
          <div class="col-md-4">
            <h1 class="text-success">{{totalDeployed}}</h1> Deployed
          </div>
          <div class="col-md-4">
            <h1 class="text-warning">{{totalUndefined}}</h1> Undefined
          </div>
        </div>

        <div class"row text-center">
          <div class="col-md-4">
          </div>
          <div class="col-md-4">
            <h1 class="text-success">{{totalUndeployed}}</h1> Undeployed
          </div>
          <div class="col-md-4">
            <h1 class="text-danger">{{totalErrored}}</h1> Error
          </div>
        </div>
      </div>

      <div id="forceGraph" class="text-center"></div>
      <h4>Instance State Details</h4>
      <!-- <div class="col-md-9"> -->
      <div class="btn-group">
        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
          Add New Instance <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu" >
          <li ng-repeat="role in roles"><a ng-click="addNewRole(role)">{{role}}</a></li>
        </ul>
      </div>
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Name</th>
            <th>Internal IP</th>
            <th>Public IP</th>
            <th>Stage</th>
            <th>Planned Stage</th>
            <th>More Info</th>
            <th>Operations</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="instance in instances">
            <td>{{instance.name}}</td>
            <td>[{{instance.interfaces[0].ip_address}}]</td>
            <td>{{instance.public_ip[0].ip_address}}</td>
            <td ng-if="instance.stage == 'undefined'">
              <span class="label label-warning">{{instance.stage}}</span>
            </td>
            <td ng-if="instance.stage == 'deploy'">
              <span class="label label-success">{{instance.stage}}</span>
            </td>
            <td ng-if="instance.stage == 'undeployed'">
              <span class="label label-success">{{instance.stage}}</span>
            </td>
            <td ng-if="instance.stage == 'error'">
              <span class="label label-danger">{{instance.stage}}</span>
            </td>
            <td ng-if="instance.planned_stage == 'undefined'">
              <span class="label label-warning">{{instance.planned_stage}}</span>
            </td>
            <td ng-if="instance.planned_stage == 'deploy'">
              <span class="label label-success">{{instance.planned_stage}}</span>
            </td>
            <td ng-if="instance.planned_stage == 'undeployed'">
              <span class="label label-success">{{instance.planned_stage}}</span>
            </td>
            <td ng-if="instance.planned_stage == 'error'">
              <span class="label label-danger">{{instance.planned_stage}}</span>
            </td>
            <td>
              <div ng-controller="MainCtrl">
                  <script type="text/ng-template" id="myModalContent.html">
                      <div class="modal-header">
                          <h3>Instance Details</h3>
                      </div>
                      <div class="modal-body">
                          <ul>
                              <li ng-repeat="(key,item) in items">
                                  <a ng-click="selected.item = item">{{key}} - {{ item }}</a>
                              </li>
                          </ul>
                          Selected: <b>{{ selected.item }}</b>
                        <h4>Advanced Details</h4>
                      </div>
                      <div class="modal-footer">
                          <button class="btn btn-primary" ng-click="ok()">OK</button>
                          <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                      </div>
                  </script>

                  <button class='btn btn-info' ng-click="open(instance)">View</button>
              </div>
            </td>
            <td>
              <div class="btn-group">
                <button type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown">
                  Action <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                  <li><a ng-click="replaceInstance(instance.id)">Replace</a></li>
                  <li><a ng-click="deleteInstance(instance.id)">Delete</a></li>
                </ul>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="footer">
  <p>ancor-dashboard {{adVersion}} | Kansas State University | Brian Cain 2014</p>
</div>

<script src="scripts/forced-graph.js"></script>
